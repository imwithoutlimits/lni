<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The Calling — Total Man 100-Day Journey | LNI Global</title>
<meta property="og:title" content="Are You Ready? The Total Man — 100-Day Journey">
<meta property="og:description" content="This is not a form. This is a calling. 22nd March 2026. Lehem Network International.">
<meta property="og:image" content="https://lehemnetwork.org/lni-og-image.png">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Cinzel+Decorative:wght@700&family=Lato:ital,wght@0,300;0,400;1,300;1,400&display=swap" rel="stylesheet">
<style>
:root{
  --gold:#C9922A;--gold-l:#F0C060;--gold-p:#FAE8B0;
  --deep:#070503;--dark:#110D06;--dim:#3A2E1A;
  --text:#EDE0C8;--muted:#7A6A50;
}
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden}
body{font-family:'Lato',sans-serif;background:var(--deep);color:var(--text)}

#canvas{position:fixed;inset:0;pointer-events:none;z-index:0}

/* ── SCENES ── */
.scene{
  position:fixed;inset:0;display:flex;flex-direction:column;
  align-items:center;justify-content:center;
  padding:60px 24px 80px;z-index:10;
  opacity:0;pointer-events:none;transition:opacity 0.9s ease;
}
.scene.active{opacity:1;pointer-events:all}

/* ── PROGRESS ── */
#prog{
  position:fixed;top:24px;left:50%;transform:translateX(-50%);
  z-index:100;display:flex;align-items:center;gap:8px;
  opacity:0;transition:opacity 0.5s;
}
#prog.show{opacity:1}
.pd{
  width:7px;height:7px;border-radius:50%;
  background:var(--dim);transition:all 0.4s;
}
.pd.done{background:var(--gold-l)}
.pd.now{
  background:var(--gold);transform:scale(1.5);
  box-shadow:0 0 10px rgba(201,146,42,0.6);
}

/* ── BACK BTN ── */
#nav{
  position:fixed;bottom:24px;left:50%;transform:translateX(-50%);
  z-index:100;opacity:0;transition:opacity 0.5s;
}
#nav.show{opacity:1}
.nbtn{
  background:transparent;border:1px solid var(--dim);border-radius:30px;
  padding:8px 22px;color:var(--muted);font-family:'Lato',sans-serif;
  font-size:12px;letter-spacing:0.08em;cursor:pointer;transition:all 0.2s;
}
.nbtn:hover{border-color:var(--gold);color:var(--gold)}

/* ── BURST ── */
#burst{
  position:fixed;inset:0;pointer-events:none;z-index:200;
  display:flex;align-items:center;justify-content:center;opacity:0;
}
.bsym{
  font-family:'Cinzel Decorative',serif;font-size:10rem;color:var(--gold);
  text-shadow:0 0 80px rgba(201,146,42,0.9);opacity:0;transform:scale(0.2);
}
@keyframes bpop{
  0%{opacity:0;transform:scale(0.2)}
  35%{opacity:0.7;transform:scale(1.15)}
  100%{opacity:0;transform:scale(2)}
}
.bsym.go{animation:bpop 0.65s ease forwards}

/* ── INTRO ── */
#si{text-align:center}
.i-tag{
  font-size:11px;color:var(--gold);letter-spacing:0.35em;
  text-transform:uppercase;margin-bottom:36px;
  opacity:0;animation:fup 1s 0.5s ease forwards;
}
.i-title{
  font-family:'Cinzel Decorative',serif;
  font-size:clamp(3rem,10vw,6.5rem);
  color:var(--gold-p);line-height:1;
  opacity:0;animation:fup 1s 1s ease forwards;
  text-shadow:0 0 100px rgba(201,146,42,0.25);
}
.i-title span{color:var(--gold)}
.i-sub{
  font-size:clamp(0.9rem,2.5vw,1.2rem);color:var(--muted);
  margin-top:14px;font-style:italic;font-weight:300;
  opacity:0;animation:fup 1s 1.8s ease forwards;
}
.i-date{
  margin-top:20px;font-family:'Cinzel',serif;font-size:13px;
  color:var(--gold);letter-spacing:0.2em;
  opacity:0;animation:fup 1s 2.4s ease forwards;
}
.i-btn{
  margin-top:52px;padding:18px 56px;
  background:transparent;border:1px solid rgba(201,146,42,0.5);
  border-radius:2px;color:var(--gold-p);
  font-family:'Cinzel',serif;font-size:14px;
  letter-spacing:0.25em;cursor:pointer;
  transition:all 0.4s;position:relative;overflow:hidden;
  opacity:0;animation:fup 1s 3s ease forwards;
}
.i-btn::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,var(--gold),var(--gold-l));
  transform:scaleX(0);transform-origin:left;
  transition:transform 0.4s;z-index:-1;
}
.i-btn:hover{color:var(--deep);border-color:var(--gold)}
.i-btn:hover::before{transform:scaleX(1)}

/* ── SCRIPTURE ── */
.sw{text-align:center;max-width:580px}
.st{
  font-family:'Cinzel',serif;
  font-size:clamp(1rem,2.8vw,1.5rem);
  color:var(--text);line-height:1.75;font-style:italic;
  opacity:0;transform:translateY(20px);
  transition:all 0.9s 0.3s;
}
.scene.active .st{opacity:1;transform:translateY(0)}
.sr{
  margin-top:18px;font-size:12px;color:var(--gold);
  letter-spacing:0.2em;opacity:0;transition:opacity 0.6s 1.4s;
}
.scene.active .sr{opacity:1}
.sb{
  margin-top:44px;padding:13px 34px;
  background:transparent;border:1px solid rgba(201,146,42,0.2);
  border-radius:2px;color:var(--gold);font-family:'Cinzel',serif;
  font-size:12px;letter-spacing:0.2em;cursor:pointer;
  opacity:0;transition:opacity 0.6s 2.2s,all 0.3s;
}
.scene.active .sb{opacity:1}
.sb:hover{background:rgba(201,146,42,0.07);border-color:var(--gold)}

/* ── QUESTION SCENE ── */
.qs{text-align:center;max-width:700px;width:100%}
.qctx{
  font-size:11px;color:var(--gold);letter-spacing:0.3em;
  text-transform:uppercase;margin-bottom:16px;
  opacity:0;transition:opacity 0.6s 0.1s;
}
.scene.active .qctx{opacity:1}
.qq{
  font-family:'Cinzel',serif;
  font-size:clamp(1.3rem,4vw,2.2rem);
  color:var(--gold-p);line-height:1.35;margin-bottom:10px;
  opacity:0;transform:translateY(24px);transition:all 0.7s 0.25s;
}
.scene.active .qq{opacity:1;transform:translateY(0)}
.qh{
  font-size:13px;color:var(--muted);font-style:italic;
  margin-bottom:36px;opacity:0;transition:opacity 0.6s 0.5s;
}
.scene.active .qh{opacity:1}

/* TEXT INPUT */
.qiw{
  position:relative;max-width:460px;margin:0 auto;
  opacity:0;transform:translateY(14px);transition:all 0.6s 0.5s;
}
.scene.active .qiw{opacity:1;transform:translateY(0)}
.qi{
  width:100%;background:transparent;border:none;
  border-bottom:1px solid var(--dim);padding:14px 0;
  color:var(--text);font-family:'Lato',sans-serif;
  font-size:clamp(1.1rem,3vw,1.55rem);font-weight:300;
  text-align:center;outline:none;
  transition:border-color 0.3s;caret-color:var(--gold);
}
.qi:focus{border-bottom-color:var(--gold)}
.qi::placeholder{color:var(--muted);font-style:italic}
.qul{
  position:absolute;bottom:0;left:50%;width:0;height:1px;
  background:var(--gold);transform:translateX(-50%);transition:width 0.4s;
}
.qi:focus~.qul{width:100%}

/* CONTINUE */
.qgo{
  display:inline-flex;align-items:center;gap:10px;
  background:transparent;border:none;color:var(--gold);
  font-family:'Cinzel',serif;font-size:13px;
  letter-spacing:0.15em;cursor:pointer;
  margin-top:32px;padding:8px 16px;
  opacity:0;transition:opacity 0.4s,color 0.2s;
}
.qgo.on{opacity:1}
.qgo:hover{color:var(--gold-l)}
.qgo svg{width:17px;height:17px;transition:transform 0.2s}
.qgo:hover svg{transform:translateX(4px)}
.etip{
  display:block;font-size:11px;color:var(--muted);
  letter-spacing:0.08em;margin-top:8px;
  opacity:0;transition:opacity 0.4s;
}
.etip.on{opacity:1}

/* CHOICES */
.cg{
  display:grid;gap:10px;max-width:660px;margin:0 auto;
  opacity:0;transform:translateY(14px);transition:all 0.6s 0.5s;
}
.scene.active .cg{opacity:1;transform:translateY(0)}
.cg.c2{grid-template-columns:1fr 1fr}
.cg.c3{grid-template-columns:1fr 1fr 1fr}
.ch{
  background:rgba(255,255,255,0.02);border:1px solid var(--dim);
  border-radius:6px;padding:16px 20px;cursor:pointer;
  transition:all 0.25s;text-align:left;position:relative;overflow:hidden;
}
.ch::before{
  content:'';position:absolute;inset:0;
  background:linear-gradient(135deg,rgba(201,146,42,0.07),transparent);
  opacity:0;transition:opacity 0.3s;
}
.ch:hover{border-color:var(--gold);transform:translateY(-2px)}
.ch:hover::before{opacity:1}
.ch.sel{border-color:var(--gold-l);background:rgba(201,146,42,0.07)}
.ch.sel::after{
  content:'✦';position:absolute;top:11px;right:13px;
  color:var(--gold);font-size:11px;
}
.chm{font-family:'Cinzel',serif;font-size:13px;color:var(--gold-p);letter-spacing:0.03em}
.chs{font-size:12px;color:var(--muted);font-weight:300;margin-top:3px}

/* COVENANT */
.covt{
  font-family:'Cinzel',serif;
  font-size:clamp(0.9rem,2vw,1.1rem);
  color:var(--text);line-height:1.95;
  font-style:italic;max-width:640px;text-align:center;
  border-left:2px solid var(--gold);
  padding:22px 28px;background:rgba(201,146,42,0.025);
  border-radius:0 6px 6px 0;
  opacity:0;transform:translateY(20px);transition:all 0.8s 0.3s;
}
.scene.active .covt{opacity:1;transform:translateY(0)}
.signbtn{
  margin-top:36px;padding:18px 60px;
  background:linear-gradient(135deg,var(--gold),var(--gold-l));
  border:none;border-radius:3px;color:var(--deep);
  font-family:'Cinzel',serif;font-size:14px;
  font-weight:700;letter-spacing:0.18em;cursor:pointer;
  opacity:0;transition:opacity 0.6s 2s,transform 0.3s,box-shadow 0.3s;
  box-shadow:0 8px 30px rgba(201,146,42,0.2);
}
.scene.active .signbtn{opacity:1}
.signbtn:hover{transform:translateY(-3px);box-shadow:0 14px 40px rgba(201,146,42,0.4)}

/* EMAIL SCENE — after covenant, feels tiny and obvious */
#s-email .qq{font-size:clamp(1.1rem,3vw,1.8rem)}
.email-note{
  font-size:12px;color:var(--muted);margin-top:8px;
  font-style:italic;opacity:0;transition:opacity 0.6s 0.7s;
}
.scene.active .email-note{opacity:1}

/* CARD */
#sc{align-items:center;overflow-y:auto;padding:30px 24px}
.cw{perspective:1000px;opacity:0;transition:opacity 0.6s 0.3s;flex-shrink:0}
.scene.active .cw{opacity:1}
.pcard{
  width:min(470px,88vw);
  background:linear-gradient(145deg,#1C1408,#0E0A04);
  border:1px solid var(--gold);border-radius:12px;padding:34px;
  position:relative;overflow:hidden;
  transform-style:preserve-3d;transition:transform 0.12s ease;
  box-shadow:0 0 0 1px rgba(201,146,42,0.08),
    0 24px 70px rgba(0,0,0,0.9),
    inset 0 1px 0 rgba(201,146,42,0.12);
}
.pcard::before{
  content:'';position:absolute;top:-50px;right:-50px;
  width:180px;height:180px;
  background:radial-gradient(circle,rgba(201,146,42,0.07),transparent 70%);
}
.ct{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.ctl{font-family:'Cinzel Decorative',serif;font-size:11px;color:var(--gold);letter-spacing:0.2em}
.ctr{font-size:11px;color:var(--muted);letter-spacing:0.12em}
.cdiv{height:1px;background:linear-gradient(90deg,var(--gold),transparent);margin-bottom:18px}
.cname{font-family:'Cinzel',serif;font-size:clamp(1.3rem,5vw,1.9rem);color:var(--gold-p);margin-bottom:4px}
.cloc{font-size:12px;color:var(--muted);letter-spacing:0.08em;margin-bottom:20px}
.cphase{
  display:inline-flex;align-items:center;gap:8px;
  background:rgba(201,146,42,0.07);
  border:1px solid rgba(201,146,42,0.18);
  border-radius:4px;padding:7px 13px;margin-bottom:18px;
}
.cpl{font-size:10px;color:var(--muted);letter-spacing:0.12em;text-transform:uppercase}
.cpn{font-family:'Cinzel',serif;font-size:13px;color:var(--gold)}
.cil{font-size:10px;color:var(--muted);letter-spacing:0.18em;text-transform:uppercase;margin-bottom:5px}
.ci{
  font-size:13px;color:var(--text);font-style:italic;
  font-weight:300;line-height:1.65;
  border-left:2px solid var(--gold);padding-left:11px;margin-bottom:20px;
}
.cdates{
  display:flex;justify-content:space-between;align-items:center;
  padding-top:14px;border-top:1px solid var(--dim);
}
.cdi{text-align:center}
.cdil{
  font-size:9px;color:var(--muted);letter-spacing:0.12em;
  text-transform:uppercase;display:block;margin-bottom:2px;
}
.cdv{font-family:'Cinzel',serif;font-size:12px;color:var(--gold-p)}
.cnum{position:absolute;bottom:11px;right:14px;font-size:9px;color:var(--muted);letter-spacing:0.08em}

/* CARD ACTIONS */
.cacts{
  display:flex;flex-direction:column;align-items:center;gap:14px;
  margin-top:24px;opacity:0;transition:opacity 0.6s 1.2s;flex-shrink:0;
}
.scene.active .cacts{opacity:1}
.wa{
  display:inline-flex;align-items:center;gap:12px;
  padding:14px 32px;background:#25D366;border:none;
  border-radius:6px;color:white;font-family:'Cinzel',serif;
  font-size:13px;font-weight:700;letter-spacing:0.08em;
  cursor:pointer;text-decoration:none;
  transition:all 0.25s;box-shadow:0 6px 24px rgba(37,211,102,0.22);
}
.wa:hover{transform:translateY(-2px);box-shadow:0 10px 32px rgba(37,211,102,0.38)}
.wa svg{width:20px;height:20px;fill:white;flex-shrink:0}

/* REFERRAL */
.rw{
  max-width:540px;width:100%;margin-top:0;
  opacity:0;transition:opacity 0.8s 2s;
  text-align:center;flex-shrink:0;
}
.scene.active .rw{opacity:1}
.rdiv{display:flex;align-items:center;gap:14px;margin:28px 0}
.rdivl{flex:1;height:1px;background:var(--dim)}
.rdivsym{color:var(--gold);font-size:12px}
.rhead{
  font-family:'Cinzel',serif;
  font-size:clamp(1.1rem,3vw,1.6rem);
  color:var(--gold-p);margin-bottom:14px;line-height:1.3;
}
.rsub{
  font-size:14px;color:var(--muted);
  line-height:1.85;margin-bottom:22px;font-weight:300;
}
.rnlabel{
  font-family:'Cinzel',serif;font-size:12px;color:var(--gold);
  letter-spacing:0.15em;text-transform:uppercase;margin-bottom:12px;
}
.rninputs{
  display:flex;flex-direction:column;gap:10px;
  max-width:340px;margin:0 auto 18px;
}
.rni{
  background:transparent;border:none;
  border-bottom:1px solid var(--dim);
  padding:10px 0;color:var(--text);
  font-family:'Lato',sans-serif;font-size:14px;
  font-weight:300;text-align:center;outline:none;
  transition:border-color 0.3s;caret-color:var(--gold);
}
.rni:focus{border-bottom-color:var(--gold)}
.rni::placeholder{color:var(--muted);font-style:italic;font-size:13px}
.rgenbtn{
  padding:13px 34px;
  background:linear-gradient(135deg,var(--gold),var(--gold-l));
  border:none;border-radius:3px;color:var(--deep);
  font-family:'Cinzel',serif;font-size:12px;font-weight:700;
  letter-spacing:0.15em;cursor:pointer;
  transition:all 0.25s;box-shadow:0 6px 24px rgba(201,146,42,0.2);
}
.rgenbtn:hover{transform:translateY(-2px);box-shadow:0 10px 32px rgba(201,146,42,0.35)}
.rsharebox{
  background:rgba(201,146,42,0.04);
  border:1px solid rgba(201,146,42,0.15);
  border-radius:8px;padding:20px;margin-top:16px;
  animation:fup 0.5s ease both;
}
.rsharelabel{
  font-size:9px;color:var(--gold);letter-spacing:0.28em;
  text-transform:uppercase;margin-bottom:10px;
}
.rmsgbox{
  font-size:13px;color:var(--text);line-height:1.8;
  font-weight:300;text-align:left;
  background:rgba(0,0,0,0.2);border-radius:6px;
  padding:14px;margin-bottom:14px;
  white-space:pre-line;font-family:'Lato',sans-serif;
}
.rsharebts{display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:12px}
.rwabtn{
  display:inline-flex;align-items:center;gap:8px;
  padding:11px 22px;background:#25D366;
  border:none;border-radius:6px;color:white;
  font-family:'Cinzel',serif;font-size:12px;font-weight:700;
  letter-spacing:0.06em;cursor:pointer;text-decoration:none;
  transition:all 0.2s;
}
.rwabtn:hover{transform:translateY(-2px)}
.rcopybtn{
  padding:11px 22px;background:transparent;
  border:1px solid rgba(201,146,42,0.3);border-radius:6px;
  color:var(--gold);font-family:'Cinzel',serif;
  font-size:12px;letter-spacing:0.06em;cursor:pointer;
  transition:all 0.2s;
}
.rcopybtn:hover{background:rgba(201,146,42,0.08);border-color:var(--gold)}
.rcopybtn.copied{border-color:var(--gold-l);color:var(--gold-l)}
.rnote{font-size:11px;color:var(--muted);line-height:1.6}
.rskip{
  margin-top:20px;font-size:11px;color:var(--muted);
  letter-spacing:0.1em;cursor:pointer;transition:color 0.2s;
}
.rskip:hover{color:var(--gold)}
  /* ── PROFILE ACTIONS ── */
.profile-actions{
  max-width:470px;width:min(470px,88vw);
  margin-bottom:16px;
}
.profile-actions-label{
  font-size:9px;color:var(--gold);letter-spacing:0.28em;
  text-transform:uppercase;text-align:center;
  margin-bottom:12px;
}
.pa-grid{
  display:grid;grid-template-columns:1fr 1fr;
  gap:10px;
}
.pa-btn{
  display:flex;flex-direction:column;align-items:center;
  justify-content:center;gap:8px;
  padding:16px 12px;
  background:rgba(255,255,255,0.02);
  border:1px solid var(--dim);
  border-radius:8px;cursor:pointer;
  text-decoration:none;color:var(--text);
  transition:all 0.25s;text-align:center;
}
.pa-btn:hover{
  border-color:var(--gold);
  background:rgba(201,146,42,0.06);
  transform:translateY(-2px);
}
.pa-btn svg{
  width:22px;height:22px;
  flex-shrink:0;
}
.pa-btn-title{
  font-family:'Cinzel',serif;font-size:11px;
  color:var(--gold-p);letter-spacing:0.06em;line-height:1.3;
}
.pa-btn-sub{
  font-size:10px;color:var(--muted);
  line-height:1.4;
}
.pa-btn.gold-border{border-color:rgba(201,146,42,0.3)}
.pa-btn.gold-border:hover{border-color:var(--gold-l)}
.sl{font-size:12px;color:var(--muted);text-decoration:none;letter-spacing:0.1em;transition:color 0.2s}
.sl:hover{color:var(--gold)}

@keyframes fup{from{opacity:0;transform:translateY(18px)}to{opacity:1;transform:translateY(0)}}
@media(max-width:600px){
  .cg.c2{grid-template-columns:1fr}
  .cg.c3{grid-template-columns:1fr}
  .pcard{padding:22px 18px}
}
</style>
</head>
<body>
<canvas id="canvas"></canvas>
<div id="prog"></div>
<div id="burst"><div class="bsym">✦</div></div>
<div id="nav"><button class="nbtn" onclick="goBack()">← Back</button></div>

<!-- INTRO -->
<div class="scene active" id="si">
  <p class="i-tag">Lehem Network International · 2026</p>
  <h1 class="i-title">The Total<br><span>Man</span></h1>
  <p class="i-sub">"This is not a programme. This is a pursuit."</p>
  <p class="i-date">22 March — 30 June 2026 &nbsp;·&nbsp; 100 Days</p>
  <button class="i-btn" onclick="begin()">I AM READY &nbsp;→</button>
</div>

<!-- SCRIPTURE 1 -->
<div class="scene" id="ss1">
  <div class="sw">
    <p class="st">"But we all, with unveiled face, beholding as in a mirror the glory of the Lord, are being transformed into the same image from glory to glory."</p>
    <p class="sr">— 2 Corinthians 3:18</p>
    <button class="sb" onclick="next()">This is my desire &nbsp;→</button>
  </div>
</div>

<!-- Q1: FIRST NAME ONLY — the only early ask -->
<div class="scene qs" id="s-name">
  <p class="qctx">Let us begin</p>
  <h2 class="qq">What do people call you?</h2>
  <p class="qh">Just your first name. That is enough for now.</p>
  <div class="qiw">
    <input class="qi" id="fn" type="text" placeholder="Your first name" autocomplete="off" autocapitalize="words">
    <div class="qul"></div>
  </div>
  <button class="qgo" id="bg-name" onclick="next()">
    That is who I am
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
  </button>
  <span class="etip" id="et-name">Press Enter to continue</span>
</div>

<!-- Q2: SPIRITUAL STATE — choice, no data feel -->
<div class="scene qs" id="s-spirit">
  <p class="qctx">No wrong answers here</p>
  <h2 class="qq" id="q-spirit-head">Where are you right now, spiritually?</h2>
  <p class="qh">Be honest. Just between you and God — and us.</p>
  <div class="cg c2" id="cg-spirit">
    <div class="ch" onclick="pick(this,'ss','Growing — but wanting more')">
      <div class="chm">Growing — but wanting more</div>
      <div class="chs">The hunger is real. I need fuel.</div>
    </div>
    <div class="ch" onclick="pick(this,'ss','Stagnant — need a breakthrough')">
      <div class="chm">Stagnant — need a breakthrough</div>
      <div class="chs">Something has to change.</div>
    </div>
    <div class="ch" onclick="pick(this,'ss','Strong — want to go deeper')">
      <div class="chm">Strong — want to go deeper</div>
      <div class="chs">There is always another level.</div>
    </div>
    <div class="ch" onclick="pick(this,'ss','Returning after a dry season')">
      <div class="chm">Returning after a dry season</div>
      <div class="chs">This feels like my moment.</div>
    </div>
  </div>
</div>

<!-- Q3: PHASE — choice -->
<div class="scene qs" id="s-phase">
  <p class="qctx">Your entry point</p>
  <h2 class="qq">Which part of you needs the most work?</h2>
  <p class="qh">Be ruthlessly honest. This becomes your focus phase.</p>
  <div class="cg c2" id="cg-phase">
    <div class="ch" onclick="pick(this,'pp','Spirit')">
      <div class="chm">My Spirit</div>
      <div class="chs">My inner man is passive and underdeveloped</div>
    </div>
    <div class="ch" onclick="pick(this,'pp','Mind')">
      <div class="chm">My Mind</div>
      <div class="chs">My thinking doesn't match what I believe</div>
    </div>
    <div class="ch" onclick="pick(this,'pp','Body')">
      <div class="chm">My Body</div>
      <div class="chs">My flesh is winning too many battles</div>
    </div>
    <div class="ch" onclick="pick(this,'pp','Authority')">
      <div class="chm">My Authority</div>
      <div class="chs">I know the theory but not the experience</div>
    </div>
  </div>
</div>

<!-- SCRIPTURE 2 — breath in the middle -->
<div class="scene" id="ss2">
  <div class="sw">
    <p class="st">"That He would grant you, according to the riches of His glory, to be strengthened with power through His Spirit in the inner man."</p>
    <p class="sr">— Ephesians 3:16</p>
    <button class="sb" onclick="next()">I receive this &nbsp;→</button>
  </div>
</div>

<!-- Q4: LOCATION — woven in naturally mid-journey -->
<div class="scene qs" id="s-loc">
  <p class="qctx">The network spans the earth</p>
  <h2 class="qq" id="q-loc-head">Where in the world are you?</h2>
  <p class="qh">Every city represented in this journey is a node in something global.</p>
  <div class="qiw" style="display:flex;flex-direction:column;gap:18px;max-width:440px;margin:0 auto">
    <div style="position:relative">
      <input class="qi" id="cy" type="text" placeholder="City" autocomplete="off">
      <div class="qul"></div>
    </div>
    <div style="position:relative">
      <input class="qi" id="co" type="text" placeholder="Country" autocomplete="off">
      <div class="qul"></div>
    </div>
  </div>
  <button class="qgo" id="bg-loc" onclick="next()">
    This is where I stand
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
  </button>
  <span class="etip" id="et-loc">Press Enter to continue</span>
</div>

<!-- Q5: INTENTION — the deep ask -->
<div class="scene qs" id="s-intent">
  <p class="qctx">The most important question</p>
  <h2 class="qq">Complete this sentence:</h2>
  <p class="qh" style="color:var(--gold);font-size:1rem">"God, I want these 100 days to..."</p>
  <div class="qiw" style="max-width:540px">
    <textarea id="it" class="qi" rows="3"
      placeholder="Write it. Don't overthink. Let it come."
      style="resize:none;text-align:left;font-size:1rem;line-height:1.7;padding:14px 0"
    ></textarea>
    <div class="qul"></div>
  </div>
  <button class="qgo" id="bg-intent" onclick="next()">
    This is my prayer
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
  </button>
  <span class="etip" id="et-intent">Press Enter to continue</span>
</div>

<!-- Q6: SOURCE — light and easy -->
<div class="scene qs" id="s-source">
  <p class="qctx">Almost there</p>
  <h2 class="qq">How did you find out about this?</h2>
  <p class="qh">We want to know what God used.</p>
  <div class="cg c2" id="cg-src">
    <div class="ch" onclick="pick(this,'src','WhatsApp')"><div class="chm">WhatsApp</div></div>
    <div class="ch" onclick="pick(this,'src','Social Media')"><div class="chm">Social Media</div></div>
    <div class="ch" onclick="pick(this,'src','A friend or family')"><div class="chm">A friend or family</div></div>
    <div class="ch" onclick="pick(this,'src','My leader or church')"><div class="chm">My leader or church</div></div>
    <div class="ch" onclick="pick(this,'src','LNI Website')"><div class="chm">LNI Website</div></div>
    <div class="ch" onclick="pick(this,'src','Other')"><div class="chm">Other</div></div>
  </div>
</div>

<!-- COVENANT -->
<div class="scene" id="s-cov" style="text-align:center">
  <p class="qctx" style="opacity:1;margin-bottom:24px">One final thing</p>
  <p class="covt">
    "I, <span id="covn" style="color:var(--gold-p);font-style:normal;font-weight:600"></span>,
    am enrolling in The Total Man 100-Day Journey not as a programme to complete,
    but as a pursuit of God. I commit to showing up — daily.
    To pray, to read, to confess, to drill, to fast when required,
    and to journal honestly.
    I understand that the fruit of these 100 days is not a certificate.
    It is a new man. I enter this with God, with myself,
    and with the community that walks beside me."
  </p>
  <button class="signbtn" onclick="afterCovenant()">I SIGN THIS &nbsp;✦</button>
</div>

<!-- EMAIL — after covenant, feels like almost nothing -->
<div class="scene qs" id="s-email">
  <p class="qctx">One last thing</p>
  <h2 class="qq" id="q-email-head">Where should we send important updates?</h2>
  <p class="qh">Your covenant is signed. Just need a way to reach you.</p>
  <p class="email-note">No noise. Only what matters.</p>
  <div class="qiw" style="margin-top:8px">
    <input class="qi" id="em" type="email" placeholder="your@email.com" autocomplete="off">
    <div class="qul"></div>
  </div>
  <button class="qgo" id="bg-email" onclick="submitAndShow()">
    Complete My Enrolment
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12h14M12 5l7 7-7 7"/></svg>
  </button>
  <span class="etip" id="et-email">Press Enter to complete</span>
</div>

<!-- CARD + REFERRAL -->
<div class="scene" id="sc" style="overflow-y:auto;align-items:center;gap:0;padding:28px 20px 40px">
  <div class="cw">
    <div class="pcard" id="pc">
      <div class="ct">
        <span class="ctl">LNI GLOBAL</span>
        <span class="ctr">100-DAY · 2026</span>
      </div>
      <div class="cdiv"></div>
      <div class="cname" id="cn">—</div>
      <div class="cloc" id="cl">—</div>
      <div class="cphase">
        <span class="cpl">Entry Phase</span>
        <span class="cpn" id="cph">—</span>
      </div>
      <div class="cil">My Intention</div>
      <div class="ci" id="cint">—</div>
      <div class="cdates">
        <div class="cdi"><span class="cdil">Start</span><span class="cdv">22 Mar</span></div>
        <span style="color:var(--gold)">✦</span>
        <div class="cdi"><span class="cdil">End</span><span class="cdv">30 Jun</span></div>
        <span style="color:var(--gold)">✦</span>
        <div class="cdi"><span class="cdil">Days</span><span class="cdv">100</span></div>
      </div>
      <div class="cnum" id="cno">#TM-2026-0000</div>
    </div>
  </div>

  <!-- RETURN MESSAGE for duplicate enrollees -->
  <div id="return-msg" style="display:none;background:rgba(201,146,42,0.07);border:1px solid rgba(201,146,42,0.2);border-radius:8px;padding:14px 18px;margin-bottom:16px;text-align:center;max-width:470px;width:min(470px,88vw)">
    <p style="font-family:'Cinzel',serif;font-size:13px;color:var(--gold-p);margin-bottom:4px">Welcome back ✦</p>
    <p style="font-size:12px;color:var(--muted);line-height:1.6">This email is already enrolled. Here is your profile card.</p>
  </div>

  <!-- PROFILE URL — bookmark this -->
  <div id="profile-url-box" style="display:none;background:rgba(255,255,255,0.02);border:1px solid var(--dim);border-radius:8px;padding:12px 16px;margin-bottom:16px;max-width:470px;width:min(470px,88vw);text-align:center">
    <p style="font-size:9px;color:var(--gold);letter-spacing:0.25em;text-transform:uppercase;margin-bottom:6px">Your Profile Link — Bookmark This</p>
    <p id="profile-url-text" style="font-size:11px;color:var(--muted);word-break:break-all;margin-bottom:8px;line-height:1.5"></p>
    <button onclick="copyProfileUrl()" id="copy-profile-btn" style="background:transparent;border:1px solid rgba(201,146,42,0.25);border-radius:4px;padding:6px 16px;color:var(--gold);font-family:'Cinzel',serif;font-size:11px;letter-spacing:0.08em;cursor:pointer;transition:all 0.2s">
      Copy Link
    </button>
    <p style="font-size:11px;color:var(--muted);margin-top:6px">Save this link to view your profile anytime</p>
  </div>

  <div class="cacts">
    <a href="https://chat.whatsapp.com/K29N9Q2UmI61xwqlCQAWKo" target="_blank" class="wa">
      <svg viewBox="0 0 24 24"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347zM12 0C5.373 0 0 5.373 0 12c0 2.123.554 4.118 1.528 5.845L.057 23.998l6.306-1.652A11.954 11.954 0 0012 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 21.818a9.818 9.818 0 01-5.007-1.371l-.36-.214-3.732.978 1-3.64-.235-.374A9.818 9.818 0 1112 21.818z"/></svg>
      Join the WhatsApp Group
    </a>
    <a href="https://lehemnetwork.org" class="sl">Return to LNI Global →</a>
  </div>
   <!-- PROFILE ACTIONS -->
<div class="profile-actions">
  <p class="profile-actions-label">Your Journey Resources</p>
  <div class="pa-grid">

    <!-- Download Handbook -->
    <a href="https://lehemnetwork.org/total-man-handbook.pdf" target="_blank" class="pa-btn gold-border">
      <svg viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="1.5">
        <path d="M12 16L8 12m4 4l4-4m-4 4V4M4 20h16"/>
      </svg>
      <span class="pa-btn-title">Download Handbook</span>
      <span class="pa-btn-sub">The Total Man Study Guide</span>
    </a>

    <!-- Download Workbook -->
    <a href="https://lehemnetwork.org/total-man-workbook.pdf" target="_blank" class="pa-btn gold-border">
      <svg viewBox="0 0 24 24" fill="none" stroke="var(--gold)" stroke-width="1.5">
        <path d="M9 12h6M9 16h6M9 8h6M5 3h14a1 1 0 011 1v16a1 1 0 01-1 1H5a1 1 0 01-1-1V4a1 1 0 011-1z"/>
      </svg>
      <span class="pa-btn-title">Download Workbook</span>
      <span class="pa-btn-sub">100-Day Journal & Drills</span>
    </a>

    <!-- Join a Network -->
    <a href="https://lehemnetwork.org/join-network" target="_blank" class="pa-btn">
      <svg viewBox="0 0 24 24" fill="none" stroke="var(--gold-p)" stroke-width="1.5">
        <circle cx="12" cy="8" r="3"/>
        <circle cx="4" cy="18" r="2"/>
        <circle cx="20" cy="18" r="2"/>
        <path d="M12 11v3M12 14l-5 3M12 14l5 3"/>
      </svg>
      <span class="pa-btn-title">Join a Network</span>
      <span class="pa-btn-sub">Find your local LNI chapter</span>
    </a>

    <!-- Pioneer a Network -->
    <a href="https://lehemnetwork.org/pioneer-network" target="_blank" class="pa-btn">
      <svg viewBox="0 0 24 24" fill="none" stroke="var(--gold-p)" stroke-width="1.5">
        <path d="M12 2l3 7h7l-5.5 4 2 7L12 16l-6.5 4 2-7L2 9h7z"/>
      </svg>
      <span class="pa-btn-title">Pioneer a Network</span>
      <span class="pa-btn-sub">Start a chapter in your city</span>
    </a>

  </div>
</div>
  <!-- REFERRAL -->
  <div class="rw" id="rw">
    <div class="rdiv">
      <span class="rdivl"></span><span class="rdivsym">✦</span><span class="rdivl"></span>
    </div>
    <p style="font-size:10px;color:var(--gold);letter-spacing:0.3em;text-transform:uppercase;margin-bottom:10px">
      Your enrolment is sealed.
    </p>
    <h3 class="rhead">A Total Man does not walk alone.</h3>
    <p class="rsub">
      David had his Mighty Men. Paul had Timothy and Silas.
      Jesus sent them out <em>two by two.</em>
      <br><br>
      Think of <strong style="color:var(--gold-p)">three people</strong>
      who need these 100 days as much as you do.
      Not everyone will say yes. But the right ones will —
      and the journey becomes something else entirely when you do it together.
    </p>
    <!-- SINGLE INVITATION MESSAGE — they copy and forward themselves -->
    <div class="rsharebox" id="rsbox">
      <p class="rsharelabel">YOUR INVITATION TO FORWARD</p>
      <p class="rnote" style="margin-bottom:12px;font-size:12px">
        Copy this message. Send it to each friend individually on WhatsApp.
        You can replace <strong style="color:var(--gold-p)">[Friend's name]</strong> with their actual name before sending.
      </p>
      <div class="rmsgbox" id="rmsg" style="background:rgba(0,0,0,0.25);border-radius:8px;padding:16px;font-size:13px;color:var(--text);line-height:1.8;text-align:left;white-space:pre-line;font-family:'Lato',sans-serif;margin-bottom:14px"></div>
      <div style="display:flex;gap:10px;justify-content:center;flex-wrap:wrap;margin-bottom:6px">
        <a class="rwabtn" id="rwabtn" href="#" target="_blank">
          <svg viewBox="0 0 24 24" fill="white" width="17" height="17"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347zM12 0C5.373 0 0 5.373 0 12c0 2.123.554 4.118 1.528 5.845L.057 23.998l6.306-1.652A11.954 11.954 0 0012 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 21.818a9.818 9.818 0 01-5.007-1.371l-.36-.214-3.732.978 1-3.64-.235-.374A9.818 9.818 0 1112 21.818z"/></svg>
          Send on WhatsApp
        </a>
        <button class="rcopybtn" id="rcpbtn" onclick="copyShareMsg()">Copy Message</button>
      </div>
      <p class="rnote">Anyone who receives this link goes through the same experience you just completed.</p>

      <!-- BIG JOIN COMMUNITY BANNER -->
      <div class="join-community-banner">
        <p class="jcb-label">Don't forget —</p>
        <p class="jcb-heading">Join the WhatsApp Community</p>
        <p class="jcb-sub">Daily reminders · Accountability · Prayer · 100 days together</p>
        <a href="https://chat.whatsapp.com/K29N9Q2UmI61xwqlCQAWKo" target="_blank" class="jcb-btn">
          <svg viewBox="0 0 24 24" fill="white" width="22" height="22"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347zM12 0C5.373 0 0 5.373 0 12c0 2.123.554 4.118 1.528 5.845L.057 23.998l6.306-1.652A11.954 11.954 0 0012 24c6.627 0 12-5.373 12-12S18.627 0 12 0zm0 21.818a9.818 9.818 0 01-5.007-1.371l-.36-.214-3.732.978 1-3.64-.235-.374A9.818 9.818 0 1112 21.818z"/></svg>
          Join the Total Man WhatsApp Group →
        </a>
      </div>
    </div>
    <p class="rskip" onclick="skipShare()">I will do this later →</p>
  </div>
</div>

<style>
.person-share-card{
  background:rgba(201,146,42,0.04);
  border:1px solid rgba(201,146,42,0.18);
  border-radius:8px;padding:14px 16px;
  margin-bottom:10px;animation:fup 0.4s ease both;
}
.psc-name{
  font-family:'Cinzel',serif;font-size:14px;
  color:var(--gold-p);margin-bottom:10px;letter-spacing:0.05em;
}
.psc-btns{display:flex;gap:10px;align-items:center}
.join-community-banner{
  margin-top:20px;
  background:linear-gradient(135deg,rgba(37,211,102,0.08),rgba(37,211,102,0.03));
  border:1px solid rgba(37,211,102,0.3);
  border-radius:10px;padding:22px 18px;text-align:center;
}
.jcb-label{
  font-size:10px;color:rgba(37,211,102,0.7);
  letter-spacing:0.25em;text-transform:uppercase;margin-bottom:6px;
}
.jcb-heading{
  font-family:'Cinzel',serif;font-size:clamp(1rem,3.5vw,1.3rem);
  color:#fff;margin-bottom:6px;font-weight:600;
}
.jcb-sub{
  font-size:12px;color:rgba(255,255,255,0.45);
  margin-bottom:18px;line-height:1.5;
}
.jcb-btn{
  display:inline-flex;align-items:center;justify-content:center;
  gap:10px;width:100%;padding:16px 18px;
  background:#25D366;border:none;border-radius:8px;
  color:white;font-family:'Cinzel',serif;
  font-size:clamp(12px,3vw,14px);font-weight:700;
  letter-spacing:0.08em;cursor:pointer;
  text-decoration:none;transition:all 0.25s;
  box-shadow:0 6px 24px rgba(37,211,102,0.3);
}
.jcb-btn:hover{transform:translateY(-2px);box-shadow:0 10px 32px rgba(37,211,102,0.45)}
</style>

<!-- FIREBASE -->
<script type="module">
import{initializeApp}from'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
import{getFirestore,addDoc,collection,serverTimestamp,getDocs,query,where}from'https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js';
const cfg={
  apiKey: "AIzaSyDSTqQrkY5tiSPoNsE12VpFH-aiV-bD2sg",
  authDomain: "lni-global.firebaseapp.com",
  projectId: "lni-global",
  storageBucket: "lni-global.firebasestorage.app",
  messagingSenderId: "1011021757015",
  appId: "1:1011021757015:web:e01c90d5c29925adf6c112"
  };;
const app=initializeApp(cfg);
const db=getFirestore(app);
window._db=db;window._add=addDoc;window._col=collection;window._ts=serverTimestamp;window._getDocs=getDocs;window._query=query;window._where=where;
</script>

<script>
// PARTICLES
const cv=document.getElementById('canvas'),cx=cv.getContext('2d');
let W,H,pts=[];
function rsz(){W=cv.width=innerWidth;H=cv.height=innerHeight}
rsz();addEventListener('resize',rsz);
function mkp(){return{x:Math.random()*W,y:H+5,s:Math.random()*1.4+0.2,sp:Math.random()*0.35+0.08,o:Math.random()*0.35+0.04,d:(Math.random()-0.5)*0.25}}
for(let i=0;i<55;i++){const p=mkp();p.y=Math.random()*H;pts.push(p)}
(function anim(){
  cx.clearRect(0,0,W,H);
  pts.forEach((p,i)=>{
    p.y-=p.sp;p.x+=p.d;p.o-=0.00022;
    if(p.y<-5||p.o<=0)pts[i]=mkp();
    cx.beginPath();cx.arc(p.x,p.y,p.s,0,Math.PI*2);
    cx.fillStyle=`rgba(201,146,42,${p.o})`;cx.fill();
  });requestAnimationFrame(anim);
})();

// SCENE MANAGEMENT
// Scene order — note: data is dissolved throughout
const SCENES=[
  'si',       // 0 intro
  'ss1',      // 1 scripture
  's-name',   // 2 first name only
  's-spirit', // 3 spiritual state (choice)
  's-phase',  // 4 phase (choice)
  'ss2',      // 5 scripture
  's-loc',    // 6 city + country (mid-journey)
  's-intent', // 7 intention
  's-source', // 8 how heard (choice)
  's-cov',    // 9 covenant
  's-email',  // 10 email — after covenant, feels trivial
  'sc',       // 11 card + referral
];

// Which scenes get progress dots
const PDOTS=['s-name','s-spirit','s-phase','s-loc','s-intent','s-source','s-cov','s-email'];

let idx=0;
const A={fn:'',city:'',country:'',email:'',ss:'',pp:'',intent:'',src:''};

// Build progress dots
const prog=document.getElementById('prog');
PDOTS.forEach((_,i)=>{
  const d=document.createElement('div');d.className='pd';d.id='pd'+i;prog.appendChild(d);
});

function upChrome(){
  const pi=PDOTS.indexOf(SCENES[idx]);
  prog.classList.toggle('show',pi>=0);
  document.getElementById('nav').classList.toggle('show',idx>1&&SCENES[idx]!=='sc');
  PDOTS.forEach((_,i)=>{
    const d=document.getElementById('pd'+i);
    d.classList.remove('now','done');
    if(i<pi)d.classList.add('done');
    else if(i===pi)d.classList.add('now');
  });
}

function goTo(i){
  document.getElementById(SCENES[idx]).classList.remove('active');
  idx=i;
  document.getElementById(SCENES[idx]).classList.add('active');
  upChrome();
  setTimeout(()=>{
    const inp=document.querySelector(`#${SCENES[idx]} input,#${SCENES[idx]} textarea`);
    if(inp)inp.focus();
  },550);
}

window.begin=()=>{burst();setTimeout(()=>goTo(1),420)};
window.next=()=>{if(!validate())return;collect();burst();setTimeout(()=>goTo(idx+1),420)};
window.goBack=()=>{if(idx>1)goTo(idx-1)};

function burst(){
  const b=document.getElementById('burst'),s=b.querySelector('.bsym');
  b.style.opacity=1;s.classList.remove('go');void s.offsetWidth;s.classList.add('go');
  setTimeout(()=>{b.style.opacity=0;s.classList.remove('go')},660);
}

function flash(m){
  let el=document.getElementById('fl');
  if(!el){
    el=document.createElement('div');el.id='fl';
    el.style.cssText='position:fixed;bottom:70px;left:50%;transform:translateX(-50%);background:rgba(220,60,60,0.1);border:1px solid rgba(220,60,60,0.28);border-radius:6px;padding:10px 22px;color:#F08080;font-size:13px;z-index:300;transition:opacity 0.3s';
    document.body.appendChild(el);
  }
  el.textContent=m;el.style.opacity=1;
  clearTimeout(el._t);el._t=setTimeout(()=>el.style.opacity=0,3200);
}

function validate(){
  const s=SCENES[idx];
  if(s==='s-name'&&!document.getElementById('fn').value.trim())return flash('Please tell us your name.'),false;
  if(s==='s-loc'){
    if(!document.getElementById('cy').value.trim()||!document.getElementById('co').value.trim())
      return flash('Please enter both your city and country.'),false;
  }
  if(s==='s-intent'&&document.getElementById('it').value.trim().length<4)
    return flash('Please write your intention — even one sentence.'),false;
  if(s==='s-email'){
    const e=document.getElementById('em').value.trim();
    if(!e||!e.includes('@'))return flash('Please enter a valid email address.'),false;
  }
  return true;
}

function collect(){
  const s=SCENES[idx];
  if(s==='s-name'){
    A.fn=document.getElementById('fn').value.trim();
    // Personalise upcoming questions with their name
    document.getElementById('q-spirit-head').textContent=`Where are you right now, ${A.fn}?`;
    document.getElementById('q-loc-head').textContent=`Where in the world are you, ${A.fn}?`;
    document.getElementById('q-email-head').textContent=`Last thing, ${A.fn} — where should we reach you?`;
  }
  if(s==='s-loc'){
    A.city=document.getElementById('cy').value.trim();
    A.country=document.getElementById('co').value.trim();
  }
  if(s==='s-intent')A.intent=document.getElementById('it').value.trim();
  if(s==='s-email')A.email=document.getElementById('em').value.trim();
}

// CHOICE SELECTION — auto advances
window.pick=function(el,field,val){
  el.closest('.cg').querySelectorAll('.ch').forEach(c=>c.classList.remove('sel'));
  el.classList.add('sel');A[field]=val;
  setTimeout(()=>window.next(),580);
};

// COVENANT — inserts name before signing
window.afterCovenant=function(){
  document.getElementById('covn').textContent=A.fn;
  burst();setTimeout(()=>goTo(SCENES.indexOf('s-email')),420);
};

// SHOW CONTINUE BTN AS USER TYPES
function wire(inpId,btnId,tipId,minLen){
  minLen=minLen||1;
  const inp=document.getElementById(inpId);
  if(!inp)return;
  inp.addEventListener('input',()=>{
    const ok=inp.value.trim().length>=minLen;
    document.getElementById(btnId)?.classList.toggle('on',ok);
    document.getElementById(tipId)?.classList.toggle('on',ok);
  });
}
wire('fn','bg-name','et-name');
wire('em','bg-email','et-email');
wire('it','bg-intent','et-intent',4);
['cy','co'].forEach(id=>{
  document.getElementById(id)?.addEventListener('input',()=>{
    const ok=document.getElementById('cy').value.trim()&&document.getElementById('co').value.trim();
    document.getElementById('bg-loc')?.classList.toggle('on',!!ok);
    document.getElementById('et-loc')?.classList.toggle('on',!!ok);
  });
});

// ENTER KEY
document.addEventListener('keydown',e=>{
  if(e.key==='Enter'&&!e.shiftKey){
    const textScenes=['s-name','s-loc','s-email'];
    if(textScenes.includes(SCENES[idx])&&document.activeElement.tagName!=='TEXTAREA'){
      e.preventDefault();window.next();
    }
    if(SCENES[idx]==='s-intent'&&document.activeElement.tagName!=='TEXTAREA'){
      e.preventDefault();window.next();
    }
  }
});

// SUBMIT + BUILD CARD — with duplicate email check
window.submitAndShow=async function(){
  if(!validate())return;
  collect();

  // ── Check for duplicate email ──
  const emailBtn=document.getElementById('bg-email');
  const origText=emailBtn.innerHTML;
  emailBtn.innerHTML='Checking...';emailBtn.classList.remove('on');

  try{
    const q=window._query(
      window._col(window._db,'total_man_enrollments'),
      window._where('email','==',A.email)
    );
    const existing=await window._getDocs(q);

    if(!existing.empty){
      // Already enrolled — load their existing profile
      const data=existing.docs[0].data();
      emailBtn.innerHTML=origText;emailBtn.classList.add('on');
      showProfile(data, true); // true = returning enrollee
      return;
    }
  }catch(e){
    console.warn('Duplicate check failed, proceeding:',e);
    emailBtn.innerHTML=origText;emailBtn.classList.add('on');
  }

  // ── New enrollee — create record ──
  const num=`#TM-2026-${String(Math.floor(Math.random()*9000)+1000)}`;
  const profileData={
    firstName:A.fn,city:A.city,country:A.country,
    email:A.email,spiritualState:A.ss,phasePull:A.pp,
    intention:A.intent,source:A.src,
    enrollNumber:num,covenantSigned:true,
    referredBy:new URLSearchParams(location.search).get('ref')||'',
    journeyStart:'22 March 2026',journeyEnd:'30 June 2026',
  };

  try{
    await window._add(window._col(window._db,'total_man_enrollments'),{
      ...profileData,enrolledAt:window._ts(),
    });
  }catch(e){console.warn('Save:',e);}
  addToBrevo({...profileData});

  // Save to localStorage so they can return
  try{localStorage.setItem('lni_tm_profile',JSON.stringify({...profileData,savedAt:new Date().toISOString()}));}catch(e){}

  showProfile(profileData, false);
};

function showProfile(data, returning){
  A.fn=data.firstName||A.fn;
  A.city=data.city||A.city;
  A.country=data.country||A.country;
  A.pp=data.phasePull||A.pp;
  A.intent=data.intention||A.intent;

  document.getElementById('cn').textContent=data.firstName;
  document.getElementById('cl').textContent=`${data.city}, ${data.country}`;
  document.getElementById('cph').textContent=data.phasePull||'—';
  const intText=(data.intention||'').length>110?(data.intention||'').slice(0,107)+'…':(data.intention||'—');
  document.getElementById('cint').textContent=intText;
  document.getElementById('cno').textContent=data.enrollNumber;

  // Show profile URL they can bookmark
  const shortId=data.enrollNumber.replace('#TM-2026-','');
  const profileUrl=`${location.origin}${location.pathname}?p=${shortId}`;  const profileBox=document.getElementById('profile-url-box');
  if(profileBox){
    document.getElementById('profile-url-text').textContent=profileUrl;
    profileBox.style.display='block';
  }

  // If returning — show a gentle message
  if(returning){
    const returnMsg=document.getElementById('return-msg');
    if(returnMsg)returnMsg.style.display='block';
    // Hide referral section for returning users
    const rw=document.getElementById('rw');
    if(rw)rw.style.display='none';
  }

  // Auto-populate share message
  setTimeout(()=>{ if(typeof genShare==='function')genShare(); },800);

  burst();setTimeout(()=>goTo(SCENES.indexOf('sc')),420);
}

// ── Load profile from URL ?p=4721 ──
async function checkViewParam(){
  const params=new URLSearchParams(location.search);
  const shortParam=params.get('p');
  if(!shortParam)return;
  const viewNum='#TM-2026-'+shortParam;
  // Skip straight to card scene, load data
  try{
    const q=window._query(
      window._col(window._db,'total_man_enrollments'),
      window._where('enrollNumber','==',viewNum)
    );
    const snap=await window._getDocs(q);
    if(!snap.empty){
      const data=snap.docs[0].data();
      // Hide all scenes, show card
      SCENES.forEach(s=>document.getElementById(s).classList.remove('active'));
      document.getElementById('sc').classList.add('active');
      showProfile(data,false);
      document.getElementById('prog').classList.remove('show');
      document.getElementById('nav').classList.remove('show');
    }
  }catch(e){console.warn('View load failed:',e);}
}
// Run after Firebase is ready
setTimeout(checkViewParam,1200);

// 3D CARD
const pc=document.getElementById('pc');
pc.addEventListener('mousemove',e=>{
  const r=pc.getBoundingClientRect();
  const x=(e.clientX-r.left)/r.width-0.5,y=(e.clientY-r.top)/r.height-0.5;
  pc.style.transform=`rotateY(${x*14}deg) rotateX(${-y*9}deg)`;
});
pc.addEventListener('mouseleave',()=>pc.style.transform='rotateY(0) rotateX(0)');

// REFERRAL — single message, user edits name and forwards themselves
function buildShareMsg(){
  const num=document.getElementById('cno').textContent;
  const pageUrl=`${location.origin}${location.pathname}?ref=${encodeURIComponent(A.fn)}`;
  return `[Friend's name],

I just enrolled in something I believe could change everything — The Total Man, a 100-day discipleship journey with Lehem Network International, starting 22nd March 2026.

100 days. Spirit. Mind. Body. Authority. Legacy.

I thought of you specifically when I finished. Not everyone gets invited. I am inviting you because I don’t want to do this alone — and I believe you are ready.

Enrol here:
${pageUrl}

— ${A.fn} (${num})

“As iron sharpens iron, so one man sharpens another.” — Prov 27:17`;
}

// Auto-populate the message box whenever the card scene is shown
window.genShare=function(){
  const msg=buildShareMsg();
  const msgEl=document.getElementById('rmsg');
  const waBtn=document.getElementById('rwabtn');
  if(msgEl)msgEl.textContent=msg;
  if(waBtn)waBtn.href=`https://wa.me/?text=${encodeURIComponent(msg)}`;
  try{
    if(window._add&&window._col&&window._db){
      window._add(window._col(window._db,'referrals'),{
        referrerName:A.fn,
        referrerNumber:document.getElementById('cno').textContent,
        createdAt:window._ts?window._ts():new Date().toISOString(),
      });
    }
  }catch(e){}
};

// Robust clipboard copy — works on all mobile browsers
function robustCopy(text,btn,label){
  label=label||'Copy';
  function fallback(){
    try{
      const ta=document.createElement('textarea');
      ta.value=text;
      ta.style.cssText='position:fixed;top:0;left:0;width:1px;height:1px;opacity:0;font-size:16px';
      document.body.appendChild(ta);ta.focus();ta.select();
      document.execCommand('copy');
      document.body.removeChild(ta);
      btn.textContent='✓ Copied';btn.classList.add('copied');
      setTimeout(()=>{btn.textContent=label;btn.classList.remove('copied');},2600);
    }catch(e){
      btn.textContent='Long-press to copy';
      setTimeout(()=>{btn.textContent=label;},3000);
    }
  }
  if(navigator.clipboard&&window.isSecureContext){
    navigator.clipboard.writeText(text)
      .then(()=>{
        btn.textContent='✓ Copied';btn.classList.add('copied');
        setTimeout(()=>{btn.textContent=label;btn.classList.remove('copied');},2600);
      })
      .catch(fallback);
  }else{
    fallback();
  }
}

window.copyShareMsg=function(){
  const msg=document.getElementById('rmsg').textContent;
  const btn=document.getElementById('rcpbtn');
  if(msg&&btn)robustCopy(msg,btn,'Copy Message');
};

window.copyProfileUrl=function(){
  const url=document.getElementById('profile-url-text').textContent;
  const btn=document.getElementById('copy-profile-btn');
  if(url&&btn)robustCopy(url,btn,'Copy Link');
};

window.skipShare=function(){
  const rw=document.getElementById('rw');
  rw.style.opacity='0';
  setTimeout(()=>rw.style.display='none',400);
};
  // ── BREVO: add contact when enrollment saves ──
async function addToBrevo(data) {
  const BREVO_KEY = "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";
  const LIST_ID = 3; // just the number, e.g. 3

  try {
    await fetch("https://api.brevo.com/v3/contacts", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "api-key": BREVO_KEY,
      },
      body: JSON.stringify({
        email: data.email,
        listIds: [LIST_ID],
        updateEnabled: true,
        attributes: {
          FIRSTNAME: data.firstName,
          CITY: data.city,
          COUNTRY: data.country,
          ENROLLNUMBER: data.enrollNumber,
          PHASE: data.phasePull || "",
          INTENTION: data.intention || "",
        },
      }),
    });
    console.log("✅ Added to Brevo");
  } catch (err) {
    console.warn("Brevo sync failed:", err.message);
  }
}
</script>
  </body>
</html>
